<html><head><meta http-equiv="X-UA-Compatible" content="IE=edge" /><link rel="shortcut icon" href="../icons/favicon.ico" /><link rel="stylesheet" type="text/css" href="../styles/branding.css" /><link rel="stylesheet" type="text/css" href="../styles/branding-en-US.css" /><script type="text/javascript" src="../scripts/branding.js"> </script><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>ISession.Send Method (IMessage[], Int32, Int32, Int32)</title><meta name="Language" content="en-us" /><meta name="Microsoft.Help.Id" content="M:SolaceSystems.Solclient.Messaging.ISession.Send(SolaceSystems.Solclient.Messaging.IMessage[],System.Int32,System.Int32,System.Int32@)" /><meta name="Description" content="Sends an array of messages over the session, attempting to send them all at once. Note that the number of messages which can be sent through a single call to this method is limited to 50. For sessions in which Send(IMessage[],..." /><meta name="Microsoft.Help.ContentType" content="Reference" /><meta name="BrandingAware" content="true" /><meta name="container" content="SolaceSystems.Solclient.Messaging" /><meta name="file" content="e74dd216-3fcc-b984-4717-261664c47f72" /><meta name="guid" content="e74dd216-3fcc-b984-4717-261664c47f72" /><link rel="stylesheet" type="text/css" href="../styles/branding-Website.css" /><script type="text/javascript" src="../scripts/jquery-1.11.0.min.js"></script><script type="text/javascript" src="../scripts/branding-Website.js"></script></head><body onload="OnLoad('cs')"><input type="hidden" id="userDataCache" class="userDataStyle" /><div class="pageHeader" id="PageHeader">Solclient<form id="SearchForm" method="get" action="#" onsubmit="javascript:TransferToSearchPage(); return false;"><input id="SearchTextBox" type="text" maxlength="200" /><button id="SearchButton" type="submit"></button></form></div><div class="pageBody"><div class="leftNav" id="leftNav"><div id="tocNav"><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="7f10bcf6-19f4-beff-0768-ced843e35168.htm" title="Solclient" tocid="roottoc">Solclient</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="7f10bcf6-19f4-beff-0768-ced843e35168.htm" title="SolaceSystems.Solclient.Messaging" tocid="7f10bcf6-19f4-beff-0768-ced843e35168">SolaceSystems.Solclient.Messaging</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="d0313c0c-596e-ddb3-0467-7ae2039bfb86.htm" title="ISession Interface" tocid="d0313c0c-596e-ddb3-0467-7ae2039bfb86">ISession Interface</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="c05429eb-7507-1fcc-d38b-e33a957c0f0e.htm" title="ISession Methods" tocid="c05429eb-7507-1fcc-d38b-e33a957c0f0e">ISession Methods</a></div><div class="toclevel1" data-toclevel="1" data-childrenloaded="true"><a class="tocExpanded" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="52a6fb9e-644e-7772-9689-4ae20b60b3d4.htm" title="Send Method " tocid="52a6fb9e-644e-7772-9689-4ae20b60b3d4">Send Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="e30d50c1-b50c-afac-4dbc-9d4ff5e7e031.htm" title="Send Method (IMessage)" tocid="e30d50c1-b50c-afac-4dbc-9d4ff5e7e031">Send Method (IMessage)</a></div><div class="toclevel2 current" data-toclevel="2"><a data-tochassubtree="false" href="e74dd216-3fcc-b984-4717-261664c47f72.htm" title="Send Method (IMessage[], Int32, Int32, Int32)" tocid="e74dd216-3fcc-b984-4717-261664c47f72">Send Method (IMessage[], Int32, Int32, Int32)</a></div></div><div id="tocResizableEW" onmousedown="OnMouseDown(event);"></div><div id="TocResize" class="tocResize"><img id="ResizeImageIncrease" src="../icons/TocOpen.gif" onclick="OnIncreaseToc()" alt="Click or drag to resize" title="Click or drag to resize" /><img id="ResizeImageReset" src="../icons/TocClose.gif" style="display:none" onclick="OnResetToc()" alt="Click or drag to resize" title="Click or drag to resize" /></div></div><div class="topicContent" id="TopicContent"><table class="titleTable"><tr><td class="titleColumn">ISession<span id="LSTD3EB1A77_0"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTD3EB1A77_0?cpp=::|nu=.");</script>Send Method (<span id="LSTD3EB1A77_1"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTD3EB1A77_1?cpp=array&lt;");</script>IMessage<span id="LSTD3EB1A77_2"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTD3EB1A77_2?cpp=&gt;|vb=()|nu=[]");</script>, Int32, Int32, Int32<span id="LSTD3EB1A77_3"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTD3EB1A77_3?cpp=%");</script>)</td></tr></table><span class="introStyle">version: 7.2.1.27</span><div class="summary">
            Sends an array of messages over the session, attempting to send them all at once.
            <p>
            Note that the number of messages which can be sent through a single call to this method is limited to <strong>50</strong>.
            </p><p>
            For sessions in which Send(IMessage[],...) is used, it is recommended that <a href="c1696908-cd92-c7ff-2c50-82f6e89b397b.htm">TcpNoDelay</a> 
            be set to true (it is enabled by default).
            In this case, multiple messages are sent at once onto a TCP connection, and therefore
            there is no need to have the operating system carry out the TCP delay algorithm to cause fuller IP packets.
            </p></div><p> </p><strong>Namespace:</strong> <a href="7f10bcf6-19f4-beff-0768-ced843e35168.htm">SolaceSystems.Solclient.Messaging</a><br /><strong>Assembly:</strong> SolaceSystems.Solclient.Messaging (in SolaceSystems.Solclient.Messaging.dll) Version: 7.2.1.27 (7.2.1.27)<div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID1RB')" onkeypress="SectionExpandCollapse_CheckKey('ID1RB', event)" tabindex="0"><img id="ID1RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Syntax</span></div><div id="ID1RBSection" class="collapsibleSection"><div class="codeSnippetContainer"><div class="codeSnippetContainerTabs"><div id="ID0ECCA_tab1" class="codeSnippetContainerTab"><a href="#" onclick="javascript:ChangeTab('ID0ECCA','cs','1','3');return false;">C#</a></div><div id="ID0ECCA_tab2" class="codeSnippetContainerTab"><a href="#" onclick="javascript:ChangeTab('ID0ECCA','vb','2','3');return false;">VB</a></div><div id="ID0ECCA_tab3" class="codeSnippetContainerTab"><a href="#" onclick="javascript:ChangeTab('ID0ECCA','cpp','3','3');return false;">C++</a></div></div><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="ID0ECCA_copyCode" href="#" onclick="javascript:CopyToClipboard('ID0ECCA');return false;" title="Copy">Copy</a></div></div><div id="ID0ECCA_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve"><span class="identifier">ReturnCode</span> <span class="identifier">Send</span>(
	<span class="identifier">IMessage</span>[] <span class="parameter">messages</span>,
	<span class="identifier">int</span> <span class="parameter">offset</span>,
	<span class="identifier">int</span> <span class="parameter">length</span>,
	<span class="keyword">out</span> <span class="identifier">int</span> <span class="parameter">messagesSent</span>
)</pre></div><div id="ID0ECCA_code_Div2" class="codeSnippetContainerCode" style="display: none"><pre xml:space="preserve"><span class="keyword">Function</span> <span class="identifier">Send</span> ( 
	<span class="parameter">messages</span> <span class="keyword">As</span> <span class="identifier">IMessage</span>(),
	<span class="parameter">offset</span> <span class="keyword">As</span> <span class="identifier">Integer</span>,
	<span class="parameter">length</span> <span class="keyword">As</span> <span class="identifier">Integer</span>,
	&lt;<span class="identifier">OutAttribute</span>&gt; <span class="keyword">ByRef</span> <span class="parameter">messagesSent</span> <span class="keyword">As</span> <span class="identifier">Integer</span>
) <span class="keyword">As</span> <span class="identifier">ReturnCode</span></pre></div><div id="ID0ECCA_code_Div3" class="codeSnippetContainerCode" style="display: none"><pre xml:space="preserve"><span class="identifier">ReturnCode</span> <span class="identifier">Send</span>(
	<span class="keyword">array</span>&lt;<span class="identifier">IMessage</span>^&gt;^ <span class="parameter">messages</span>, 
	<span class="identifier">int</span> <span class="parameter">offset</span>, 
	<span class="identifier">int</span> <span class="parameter">length</span>, 
	[<span class="identifier">OutAttribute</span>] <span class="identifier">int</span>% <span class="parameter">messagesSent</span>
)</pre></div></div></div><script type="text/javascript">AddLanguageTabSet("ID0ECCA");</script><h4 class="subHeading">Parameters</h4><dl><dt><span class="parameter">messages</span></dt><dd>Type: <span id="LSTD3EB1A77_4"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTD3EB1A77_4?cpp=array&lt;");</script><a href="75f2bae5-bd7e-322c-0cc5-4d16112790fe.htm">SolaceSystems.Solclient.Messaging<span id="LSTD3EB1A77_5"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTD3EB1A77_5?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>IMessage</a><span id="LSTD3EB1A77_6"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTD3EB1A77_6?cpp=&gt;|vb=()|nu=[]");</script><br />Array of IMessage instances. If duplicate IMessage entries were used in the messages array, 
            they <strong> must not</strong>be Guaranteed messages, in this case an ArgumentOutOfRangeException 
            is thrown </dd><dt><span class="parameter">offset</span></dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/td2s409d" target="_self">System<span id="LSTD3EB1A77_7"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTD3EB1A77_7?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>Int32</a><br />Offset into the array of first message to send.</dd><dt><span class="parameter">length</span></dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/td2s409d" target="_self">System<span id="LSTD3EB1A77_8"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTD3EB1A77_8?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>Int32</a><br />Number of messages to send, from offset.</dd><dt><span class="parameter">messagesSent</span></dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/td2s409d" target="_self">System<span id="LSTD3EB1A77_9"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTD3EB1A77_9?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>Int32</a><span id="LSTD3EB1A77_10"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTD3EB1A77_10?cpp=%");</script><br />Returns the number of messages that were sent.</dd></dl><h4 class="subHeading">Return Value</h4>Type: <a href="4eaedb16-3901-03fb-e300-7a327dc5495f.htm">ReturnCode</a><br /><a href="4eaedb16-3901-03fb-e300-7a327dc5495f.htm">SOLCLIENT_OK</a> if successful and all messages have been sent
            Or
            <a href="4eaedb16-3901-03fb-e300-7a327dc5495f.htm">SOLCLIENT_WOULD_BLOCK</a> if some messages cannot be accepted by the API immediately.
            The API signals its readiness to accept messages through a  <a href="20084581-3120-23a3-bc9a-2e57404e2c40.htm">CanSend</a> event type. 
            The messagesSent parameter contains the number of messages sent.
            <p><strong>Note:</strong> returning <a href="4eaedb16-3901-03fb-e300-7a327dc5495f.htm">SOLCLIENT_OK</a> means that the messages have been successfully copied to the underlying
            transport which does not guarantee successful delivery to the Solace appliance. In the case of persistent or non-persistent messages, the
            application will receive a subsequent <a href="20084581-3120-23a3-bc9a-2e57404e2c40.htm">Acknowledgement</a> event for all messages (persistent and non-persistent) 
            successfully delivered to the Solace appliance. For guaranteed(persistent or non-persistent) messages which cannot be accepted by the Solace 
            appliance (quota, permission or other delivery problems), a <a href="20084581-3120-23a3-bc9a-2e57404e2c40.htm">RejectedMessageError</a> event will be generated.
            </p><strong>Special Buffering of Guaranteed Messages</strong><p>
             Guaranteed messages (<span class="code">MessageDeliveryMode.Persistent</span> or <span class="code">MessageDeliveryMode.NonPersistent</span>) are
            assured by the protocol between the client and the Solace message-router.  To make developers' task easier,
            guaranteed messages are queued for delivery in many instances:
            <ul><li> While transport (TCP) flow controlled.</li><li> While message-router flow controlled.</li><li> While sessions are connecting or reconnecting.</li><li> While sessions are disconnected or down.</li></ul></p><p>
            The SDK will buffer up to a publishers window size (<a href="247f4507-a3c6-185f-03cc-c1bb45e9bca4.htm">ADPublishWindowSize</a> ) of guaranteed messages before
            solClient_session_sendMsg() will either block (when <a href="9369000e-6797-5dda-8e6a-f6cf486c736c.htm">SendBlocking</a> is enabled) or return <a href="4eaedb16-3901-03fb-e300-7a327dc5495f.htm">SOLCLIENT_WOULD_BLOCK</a>
            (on active sessions) or return <a href="4eaedb16-3901-03fb-e300-7a327dc5495f.htm">SOLCLIENT_NOT_READY</a> (on disconnected sessions).</p><p>
            For the most part this is desired behavior. Transient sessions failures do not require special handling in applications. When
            <a href="9a8e7dd1-9741-4ebd-72a4-54ad2856c996.htm">ReconnectRetries</a> is non-zero, the underlying transport will automatically reconnect and the publishing
            application does not need to concern itself with special handling for the transient reconnecting state.</p><p>
            Special consideration is required for applications using host lists. When a reconnect occurs on a different host, an application publishing
            guaranteed messages will receive the <a href="20084581-3120-23a3-bc9a-2e57404e2c40.htm">DownError</a> event with the <a href="1dd5e649-a3ad-e357-604c-c56486a6db94.htm">UnknownFlowName</a> sub-code.
            When this occurs, any queued messages are flushed.  Messages published after this event has been raised will be queued then sent after a
            subsequent connect initiated by the application by calling <a href="358e15a6-e980-5d2f-497d-ffebca2514c5.htm">Connect<span id="LSTD3EB1A77_11"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTD3EB1A77_11?cs=()|vb=|cpp=()|nu=()|fs=()");</script></a>.</p><p>
            Multi-threaded applications should be aware that some, but not necessarily all, messages published on one thread may be flushed due to
            failed reconnect, as messages published after the <a href="20084581-3120-23a3-bc9a-2e57404e2c40.htm">DownError</a> event are not flushed. If the application chooses
            to republish some or all unacknowledged messages after the send queue has been flushed there is a possibility
            that these old, republished messages may be queued after newly published messages.</p><p>
            If the possibility of old messages after new messages is a concern, it is recommended that instead of calling
            <a href="358e15a6-e980-5d2f-497d-ffebca2514c5.htm">Connect<span id="LSTD3EB1A77_12"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTD3EB1A77_12?cs=()|vb=|cpp=()|nu=()|fs=()");</script></a> on the session that has gone down, this session should instead be destroyed
            and a new session created to establish a new connection.</p></div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID2RB')" onkeypress="SectionExpandCollapse_CheckKey('ID2RB', event)" tabindex="0"><img id="ID2RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Exceptions</span></div><div id="ID2RBSection" class="collapsibleSection"><div class="tableSection"><table><tr><th>Exception</th><th>Condition</th></tr><tr><td><a href="e5061a45-4a4c-5fad-4c38-abcb15f8ddc6.htm">OperationErrorException</a></td><td>
            Thrown when the Send operation fails, see <a href="e30d50c1-b50c-afac-4dbc-9d4ff5e7e031.htm">Send(IMessage)</a> for possible sub-codes.
            </td></tr><tr><td><a href="http://msdn2.microsoft.com/en-us/library/y31w16ca" target="_self">ObjectDisposedException</a></td><td>
            Thrown when the session is already disposed (terminal state).
            </td></tr><tr><td><a href="1e4ed0be-caf7-1a93-4fcb-df4e94c332f5.htm">FatalErrorException</a></td><td>
            Thrown when an unrecoverable error occurs.
            </td></tr><tr><td><a href="http://msdn2.microsoft.com/en-us/library/27426hcy" target="_self">ArgumentNullException</a></td><td>
            Thrown if messages is null.
            </td></tr><tr><td><a href="http://msdn2.microsoft.com/en-us/library/8xt94y6e" target="_self">ArgumentOutOfRangeException</a></td><td>
            Thrown if messages has zero-length, or <strong>duplicate</strong> Guaranteed Delivery IMessage entries were passed in
            messages.
            </td></tr></table></div></div><div class="collapsibleAreaRegion" id="seeAlsoSection"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID3RB')" onkeypress="SectionExpandCollapse_CheckKey('ID3RB', event)" tabindex="0"><img id="ID3RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />See Also</span></div><div id="ID3RBSection" class="collapsibleSection"><h4 class="subHeading">Reference</h4><div class="seeAlsoStyle"><a href="d0313c0c-596e-ddb3-0467-7ae2039bfb86.htm">ISession Interface</a></div><div class="seeAlsoStyle"><a href="52a6fb9e-644e-7772-9689-4ae20b60b3d4.htm">Send Overload</a></div><div class="seeAlsoStyle"><a href="7f10bcf6-19f4-beff-0768-ced843e35168.htm">SolaceSystems.Solclient.Messaging Namespace</a></div></div></div></div><div id="pageFooter" class="pageFooter">Copyright 2004-2016 Solace Systems, Inc. All rights reserved.  <p /> Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the "Software"), to use and copy the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions: <p /> The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.  <p /> UNLESS STATED ELSEWHERE BETWEEN YOU AND SOLACE SYSTEMS, INC., THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.<div class="feedbackLink">Send comments on this topic to
        <a id="HT_MailLink" href="mailto:support_request%40solacesystems.com?Subject=Solclient">support_request@solacesystems.com</a></div><script type="text/javascript">
        var HT_mailLink = document.getElementById("HT_MailLink");
        var HT_mailLinkText = HT_mailLink.innerHTML;
        HT_mailLink.href += ": " + document.title + "\u0026body=" + encodeURIComponent("Your feedback is used to improve the documentation and the product. Your e-mail address will not be used for any other purpose and is disposed of after the issue you report is resolved. While working to resolve the issue that you report, you may be contacted via e-mail to get further details or clarification on the feedback you sent. After the issue you report has been addressed, you may receive an e-mail to let you know that your feedback has been addressed.");
        HT_mailLink.innerHTML = HT_mailLinkText;
        </script> </div></body></html>